# 管理平台文档

这是配置文件分发管理系统 　`ConfigDistributor` 　的文档，分为使用文档和开发文档两个部分。

## 使用文档

### 配置文件部分

打开管理平台，点击登录，进入管理页面。

对于配置文件，使用之前需要先添加需要的配置文件项。

配置文件有以下几个属性：

| 属性项      | 说明           | 是否必须 |
| ----------- | -------------- | -------- |
| id          | 配置文件唯一id | 是       |
| name        | 配置文件名称   | 是       |
| create_time | 创建时间       | 否       |
| description | 配置文件描述   | 否       |
| path        | 配置文件路径   | 是       |
| content     | 配置文件内容   | 是       |
| status                  |配置文件状态|是|

#### 添加配置文件

单击　`Add Config File` ，进入添加配置文件页面，添加配置文件有两种方式－手动添加和批量添加。

对于手动添加，需正确填入各项属性项，点击　`submit`　按钮，即可提交。

对于批量添加，点击页面最下方选择文件，选择一个　json 数据文件，点击 submit 提交操作。对于　json 格式可以查看本目录下的 json 文件来了解。

#### 查看配置文件

点击　`Config File List`　查看当前系统内的配置文件，点击配置文件名即可查看配置文件详细信息。

#### 编辑删除配置文件

在配置文件详细信息页面，点击　`Action`　按钮，可以选择　`Edit`　或者　`Delete`　按钮进行编辑或者删除操作。

###　服务器部分

在本项目中，被管理的服务器节点被称为　`Agent`　或者　`Server` ，一个服务器节点有以下属性项：

| 属性项      | 说明                       | 是否必须 |
| ----------- | -------------------------- | -------- |
| name        | 节点名称                   | 是       |
| ip_address  | 服务器 ip                  | 是       |
| status      | 服务器状态                 | 是       |
| configs     | 与该服务器关联的配置文件项 | 否       |
| create_time | 服务器项创建时间           | 否       |
| id          | 服务器唯一id               | 是       |

#### 添加、查看、编辑、删除服务器

操作基本与配置文件操作相同，但是编辑和添加时可以按住 ctrl 键选择多项配置文件与该服务器关联。

### 用户部分

用户是平台的使用者，是系统的管理员，所有用户拥有相同的权限，用户拥有一下属性：

| 属性项   | 说明                   | 是否必须 |
| -------- | ---------------------- | -------- |
| username | 用户名称，用于登录系统 | 是       |
| email    | 用户邮箱               | 否       |
| password | 用户密码               | 是       |

#### 查看、添加、编辑、删除用户

操作与配置文件和服务器操作相同。

####　添加　token

可以为当前用户添加　token　用于　RESTful API。单击 `GenerateApiToken`　即可添加新的　Token。

###　任务部分

用户可以在此平台上执行管理操作，每一次操作被称为　`Task`　，并拥有以下属性：

| 属性项        | 说明 | 是否必须 |
| ------------- | ---- | -------- |
| id            | 任务唯一id | 是 |
| uuid          | UUID | 是 |
| task          | 任务内容 | 是 |
| types         | 任务类型 | 是 |
| create_time   | 创建时间 | 是 |
| complete_time | 完成时间 | 是 |
|result|任务结果|是|

#### 分发配置文件

点击左栏的 `Push Config Files` ，然后选择需要推送的服务器以及配置文件，点击提交即可推送选择的配置文件到指定的服务器。

####　查看服务器配置文件

进入服务器详细信息页面，点击 `Action` ，再点击　`Inspect Server's Configs` 即可查看该服务器下所关联配置文件的内容。

#### 比对配置文件内容

点击左栏的　`Diff Config Files`　，选择需要比对的配置文件，即可进行简单比对，比对有三种类型，按字符、按行、按单词，可以根据自己需求来选择比对类型。

#### 刷新服务器连接状态

点击左栏的 `Refresh Server Connection Status`　即可刷新所有服务器到管理服务器的连接状态。

####　查看历史任务

点击左栏的 `Latest Tasks`　即可查看近期历史任务信息，在任务详细信息页面点击　`Redo This Task`　即可重新推送该任务。